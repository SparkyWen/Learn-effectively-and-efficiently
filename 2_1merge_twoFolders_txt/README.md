# 按【P序号】合并简介 + 转写文本（TXT）——GUI 工具

这是一个用于 **批量合并两个文件夹内 TXT 文件** 的小工具：  
当两个文件夹中的文件名不完全一致，但都包含相同的序号标记（如 **【P1】、【P2】…**）时，可按序号自动匹配，将“视频简介 + 视频转写文本”拼接输出为新的 TXT 文件。

---

## ✅ 适用场景

- 文件夹 A：B 站视频简介（bili_desc_txt）
- 文件夹 B：视频转写文本（yuebao_text）
- 两边文件名不完全一致，但都包含 `【P数字】`（也兼容 `[P数字]`）作为唯一对应关系

---

## ✨ 功能特点

- **可视化界面（Tkinter）**：无需命令行参数
- **按【P序号】匹配合并**：`【P12】xxx.txt` ↔ `【P12】yyy.txt`
- **只合并某个范围**：支持仅合并 `P10 ~ P80`（可只填起始或结束）
- **输出文件命名规则**：自动选择“标题更完整（更长）”的那个文件名作为输出名
- **支持递归扫描子目录**
- **支持覆盖输出 / 自动避免重名**
- **一键打开输出目录**
- **记录未匹配文件**：仅简介存在 / 仅转写存在 / 无法解析序号 / 重复序号等
- **导出日志**：保存为 `merge_log.txt`

---

## 📦 环境要求

- Python 3.8+（建议 3.10/3.11/3.12）
- 标准库即可，无需额外安装依赖（Tkinter 为 Python 自带）

---

## 🚀 运行方式

将代码保存为：

- `merge_desc_transcript_gui.py`

运行：

```bash
python merge_desc_transcript_gui.py
```

## 🧭 使用步骤（GUI）

1. **选择简介文件夹**（例如 `bili_desc_txt`）
2. **选择转写文件夹**（例如 `yuebao_text`）
3. （可选）选择 **输出文件夹**
   - 不选择则默认输出到：`简介文件夹的上级目录/merged_output`
4. （可选）填写 **P 范围**
   - 从 P：例如 `10`
   - 到 P：例如 `80`
   - 留空：表示不限制，合并全部匹配项
5. 点击 **「1) 扫描并匹配」**
   - 左侧会显示匹配表（P序号 / 两边文件名 / 输出文件名）
   - 右侧日志会显示匹配数量、未匹配清单等
6. 点击 **「2) 开始合并」**
7. 点击 **「打开输出目录」** 直接查看结果
8. 如需留档，点击 **「导出日志」** 保存日志 TXT

------

## 🧾 合并输出格式

默认输出内容结构：

- `===== 视频简介（B站）=====`
- 简介内容
- `===== 简介结束 =====`
- （空行）
- `===== 视频转写（文本）=====`
- 转写内容
- `===== 转写结束 =====`

你也可以在界面中取消勾选“加入标题分隔”，输出就会变为纯文本拼接。

------

## 🔎 匹配规则说明

- 程序通过文件名中的序号匹配：
  - `【P12】...`
  - `[P12]...`
  - 中间允许空格，例如 `【 P 12 】`
- 如果某个 P 序号在同一文件夹内出现多个文件：
  - 会自动选择“更完整”的那个（文件名更长，若还相同则选文件更大）

------

## 📄 日志与未匹配文件

日志中会记录：

- 成功匹配的序号数量
- 仅简介存在的序号（说明转写缺失）
- 仅转写存在的序号（说明简介缺失）
- 无法解析 P 序号的文件（文件名不包含【Pxx】）
- 重复 P 序号提示（自动择优合并）

可通过 **「导出日志」** 保存为 txt。

------

## ✅ 常见问题

### 1) 文件名不匹配能合并吗？

可以。只要两边文件名里都包含相同的 `【P数字】` / `[P数字]` 即可。

### 2) 输出文件为什么会多出 _1、_2？

当输出目录中已存在同名文件且未勾选“覆盖输出”时，会自动避免重名。

### 3) 有些文件没被合并？

通常是：

- 文件名缺少 `【Pxx】`，无法识别
- 另一侧缺少对应序号
- 超出了你设置的 P 范围
   可查看日志确认原因。