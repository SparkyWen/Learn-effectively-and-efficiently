# B站合集简介批量导出（每集单独 TXT）

一个带 GUI 的 Python 小工具：输入 **合集任意一集** 的视频链接（或 BV 号），自动获取该合集内 **所有视频**，并将 **每个视频自己的简介** 导出为独立 `.txt` 文件。

---

## 功能特性

- ✅ 输入合集任意一集 `https` 链接或 `BV号`，自动识别所属合集
- ✅ 自动拉取合集内全部视频（支持分页，数量多也可用）
- ✅ 每个视频生成一个独立 `.txt`
- ✅ 即使该视频简介为空，也会生成空 `.txt`
- ✅ 文件命名规则：`【P1】标题.txt、【P2】标题.txt ...`
- ✅ 自动处理 Windows 文件名非法字符、路径过长、重名冲突（自动加后缀）
- ✅ GUI 实时日志 + 进度条
- ✅ 支持停止（安全中断）
- ✅ 可选 Cookie（遇到风控/权限需要登录时再填）

---

## 原理简述（为什么只输入一集就能拿到整个合集）

1. 程序先调用 **视频详情接口**（view），用你输入的那一集 BV 获取：
   - `owner.mid`（UP 主 mid）
   - `ugc_season.id`（合集 season_id，合集唯一标识）
2. 再用 `mid + season_id` 调用 **合集列表接口**（seasons_archives_list），分页返回合集内所有视频条目：
   - 每个条目都包含 `bvid`（也就是每一集的 BV 号）
3. 遍历每个 `bvid` 再调一次 `view` 获取该集的：
   - `title`（标题）
   - `desc / desc_v2`（简介）
4. 按 `【P序号】标题.txt` 生成文件并写入简介文本。

---

## 环境要求

- Python 3.9+（推荐 3.10/3.11）
- 依赖：`requests`（GUI 使用 Tkinter，Windows/macOS/Linux 通常自带）

---

## 安装依赖

```bash
pip install requests
```

> 若你在 conda 环境中：
>  `conda activate wen`（或你的环境名）后再执行安装命令即可。

------

## 运行方式（GUI）

保存脚本为：`bili_desc_export_gui.py`

```
python bili_desc_export_gui.py
```

打开界面后：

1. 在「合集任意一集 URL 或 BV」输入框粘贴链接或 BV
2. 选择输出目录
3. 点击「开始导出」
4. 等待完成（进度条与日志会实时更新）

------

## 输出说明

默认输出目录：`bili_desc_txt/`（可在 GUI 自行选择）

输出文件命名示例：

- `【P1】第一集标题.txt`
- `【P2】第二集标题.txt`
- ...
- 若重名则自动变为：`【P12】标题 (1).txt`

文件内容规则：

- 文件内容 **仅包含该视频的简介全文**
- 若简介为空：文件存在但内容为空（空文件）

------

## Cookie（可选）何时需要填写？

当出现以下情况时建议填写 Cookie：

- 日志出现 `412` / `-403` / `访问权限不足`
- 某些视频 `view 接口失败`（可能需要登录权限）
- 频繁被风控拦截

### 如何获取 Cookie（浏览器）

1. 用浏览器打开任意 B站页面（已登录）
2. 按 `F12` 打开开发者工具
3. 找到 `Network/网络` → 任意请求 → `Request Headers` → `Cookie`
4. 复制整段 Cookie 字符串粘贴到 GUI 的 Cookie 输入框

> 常见关键字段是 `SESSDATA=...`（登录态最重要）

------

## 常见问题（FAQ）

### Q1：为什么很多视频 `desc_len=0`？

A：通常表示 UP 主没有填写该视频简介。程序按设计仍会生成对应的空 `.txt` 文件。

### Q2：为什么文件名里有些字符被替换了？

A：Windows 文件名不允许包含 `< > : " / \ | ? *` 等字符，程序会自动清理/替换以保证可保存。

### Q3：导出过程中界面会卡吗？

A：不会。导出在后台线程执行，主线程只负责 UI 更新（进度条与日志）。

### Q4：我输入的链接必须是“合集首页链接”吗？

A：不需要。只要是 **该合集内任意一集的视频链接/BV** 即可。